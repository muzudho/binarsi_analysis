# ãƒ“ãƒŠãƒ¼ã‚·è§£æ

**æƒ…å ±å‡¦ç†ç³»ã—ã‹éŠã¹ãªã„ãƒªãƒãƒ¼ã‚·**  

`binary` ï¼ˆãƒã‚¤ãƒŠãƒªãƒ¼ï¼‰ ï¼‹ `riverse` ï¼ˆãƒªãƒãƒ¼ã‚·ï¼‰ ï¼ `binarsi` ï¼ˆãƒ“ãƒŠãƒ¼ã‚·ï¼‰  


# å®Ÿè¡Œ

```shell
python main.py
```


# ã‚²ãƒ¼ãƒ ã®ç›®çš„ï¼ˆå‹ã¡æ–¹ã®èª¬æ˜ï¼‰

```
    1 2 3 4 5 6 7
  +---------------+
a |               |
b |               |
c |     0 1       |
d |               |
e |               |
f |               |
  +---------------+
```

ğŸ‘†ã€€ç›¤ã«ã¯çŸ³ã‚’ç½®ãã¾ã™ã€‚å›³é¢ã«ã¯ã€çŸ³ã¯å…ˆæ‰‹ï¼ˆé»’ç•ªï¼‰ãŒ 1ã€å¾Œæ‰‹ï¼ˆç™½ç•ªï¼‰ãŒ 0 ã¨æ›¸ãã¨ã—ã¾ã™  


å‹æ•—åˆ¤å®šã¯ï¼“æœ¬åˆ¶ã§ã™ã€‚  

ğŸ‘‡ã€€å…ˆæ‰‹ã¯é»’ç•ªã§ã™ã€‚ä»¥ä¸‹ã®ï¼“ã¤ã®å›³ã®ã‚ˆã†ã«ã€ï¼“ç¨®é¡ã®ã€€æ£’ï¼ˆåŒã˜çŸ³ãŒä¸€åˆ—ã«ä¸¦ã‚“ã ã‚‚ã®ï¼‰ã‚’ä½œã‚Œã°å‹ã¡ã§ã™ã€‚  
ä¸€åº¦ä½œã£ãŸæ£’ã¯ã€ã‚ã¨ã§å£Šã—ãŸã‚Šã€å£Šã•ã‚ŒãŸã‚Šã—ã¦ã‚‚ã€€ã™ã§ã«ä½œã£ãŸã‚‚ã®ã¨ã—ã¦åˆ¤å®šã—ã¾ã™ã€‚  
ç›¤ä¸Šã®ã©ã®ä½ç½®ã«ä½œã£ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚ä½œã‚‹é †ç•ªã¯ä»»æ„ã§ã™ã€‚åŒæ™‚ã«ä½œã£ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“  

```
    1 2 3 4 5 6 7          1 2 3 4 5 6 7          1 2 3 4 5 6 7 
  +---------------+      +---------------+      +---------------+
a |               |    a |               |    a |     1         |
b |               |    b |     1         |    b |     1         |
c |     1 1 1     |    c |       1       |    c |     1         |
d |               |    d |         1     |    d |     1         |
e |               |    e |           1   |    e |     1         |
f |               |    f |               |    f |               |
  +---------------+      +---------------+      +---------------+
```

* æ¨ªã«ï¼“ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’
* æ–œã‚ã«ï¼”ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’ï¼ˆå·¦å³åè»¢ã§ã‚‚å¯ï¼‰
* ç¸¦ã«ï¼•ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’

ğŸ‘‡ã€€å¾Œæ‰‹ã¯ç™½ç•ªã§ã™ã€‚ãƒ«ãƒ¼ãƒ«ã¯åŒæ§˜ã§ã™ãŒã€ä½œã‚‹å›³é¢ã¯ç•°ãªã‚Šã€ä»¥ä¸‹ã®ï¼“ã¤ã‚’ä½œã‚Œã°å‹ã¡ã§ã™  

```
    1 2 3 4 5 6 7          1 2 3 4 5 6 7          1 2 3 4 5 6 7 
  +---------------+      +---------------+      +---------------+
a |               |    a |               |    a |               |
b |       1       |    b |     1         |    b |               |
c |       1       |    c |       1       |    c |   1 1 1 1 1   |
d |       1       |    d |         1     |    d |               |
e |               |    e |           1   |    e |               |
f |               |    f |               |    f |               |
  +---------------+      +---------------+      +---------------+
```

* ç¸¦ã«ï¼“ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’
* æ–œã‚ã«ï¼”ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’ï¼ˆå·¦å³åè»¢ã§ã‚‚å¯ï¼‰
* æ¨ªã«ï¼•ã¤ã® 1 ãŒä¸¦ã‚“ã æ£’

TODO ãŸã ã—ã€è‡ªåˆ†ã¨ç›¸æ‰‹ãŒåŒæ™‚ã«å‹ã¤ã‚ˆã†ãªæŒ‡ã—æ‰‹ã¯ç¦æ­¢ã—ã¾ã™  


# éŠã³æ–¹

Input:  

```shell
usi
```

Output:  

```
id name KifuwarabeBinarsi
usiok
```

ğŸ‘†ã€€ã¾ãš `usi` ã¨æ‰“éµã—ã¦ãã ã•ã„ã€‚ `usiok` ãŒè¿”ã£ã¦ããŸã‚‰ã‚ªãƒ¼ã‚±ãƒ¼ã§ã™

Input:  

```shell
isready
```

Output:  

```
readyok
```

ğŸ‘†ã€€æ¬¡ã« `isready` ã¨æ‰“éµã—ã¦ãã ã•ã„ã€‚ `readyok` ãŒè¿”ã£ã¦ããŸã‚‰ã‚ªãƒ¼ã‚±ãƒ¼ã§ã™ã€‚  
ã“ã‚Œã§ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ã®æº–å‚™ãŒã§ãã¾ã—ãŸ  

Input:  

```shell
usinewgame
```

Output:  

```
[2024-08-24 15:30:59.301810] usinewgame end
```

ğŸ‘†ã€€å¯¾å±€é–‹å§‹æ™‚ã«ã¯å¿…ãš `usinewgame` ã¨æ‰“éµã—ã¦ãã ã•ã„ã€‚ ä½•ã‹ãƒ­ã‚°ãŒè¿”ã£ã¦ããŸã‚‰ã‚ªãƒ¼ã‚±ãƒ¼ã§ã™ã€‚  
ã‚²ãƒ¼ãƒ ã®ç›¤ãŒã¾ã£ã•ã‚‰ãªçŠ¶æ…‹ã«ãªã£ã¦ã„ã¾ã™ãŒã€ã“ã®ã¾ã¾ã§ã¯ã‚²ãƒ¼ãƒ ã¯å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“  

Input:  

```shell
position startpos
```

ğŸ‘†ã€€ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“éµã—ã¦ãã ã•ã„ã€‚å¹³æ‰‹åˆæœŸå±€é¢ã«ãªã‚Šã¾ã™ã€‚å¿œç­”ã¯ã‚ã‚Šã¾ã›ã‚“

Input:  

```shell
board
```

Output:  

```
[ 0 moves | init | next black]
    1 2 3 4 5 6 7
  +---------------+
a |               |
b |               |
c |     0         |
d |               |
e |               |
f |               |
  +---------------+
```

ğŸ‘†ã€€`board` ã¨æ‰“éµã™ã‚‹ã¨ã€ç¾å±€é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™


å„éƒ¨åç§°ï¼š  

```
    1 2 3 4 5 6 7
  +---------------+
a |       *       |
b |       *       |
c |       *       |
d |       *       |
e |       *       |
f |       *       |
  +---------------+
```

ğŸ‘†ã€€ä¸Šå›³ `*` ã®å ´æ‰€ã¯ 4ç­‹ï¼ˆ4th fileï¼‰ã€ã¾ãŸã¯ 4è·¯ï¼ˆ4th wayï¼‰ã¨å‘¼ã³ã¾ã™  

```
    1 2 3 4 5 6 7
  +---------------+
a |               |
b |               |
c |               |
d | * * * * * * * |
e |               |
f |               |
  +---------------+
```

ğŸ‘†ã€€ä¸Šå›³ `*` ã®å ´æ‰€ã¯ dç­‹ï¼ˆd fileï¼‰ã€ã¾ãŸã¯ dè·¯ï¼ˆd wayï¼‰ã¨å‘¼ã³ã¾ã™  

æ¬¡ã«ã€  

Input:  

```shell
sfen
```

Output:  

```
[from beginning] sfen startpos
[from present]   sfen 7/7/2o4/7/7/7 b - 0
```

ğŸ‘†ã€€`sfen` ã¨æ‰“éµã™ã‚‹ã¨ã€ï¼’ç¨®é¡ã® SFEN ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  
ã©ã¡ã‚‰ã‚‚åŒã˜ã§ã™ãŒã€å‰è€…ã®æ–¹ã¯å±€é¢ãŒé€²ã‚€ã¨æ£‹è­œãŒä»˜ãã€å¾Œè€…ã®æ–¹ã¯é€”ä¸­å›³ã®ç›¤é¢ãŒä»˜ãã¾ã™  

Input:  

```shell
legal_moves
```

Output:  

```
LEGAL MOVES
-----------
    ( 1) do 2n
    ( 2) do 4n
    ( 3) do bn
    ( 4) do dn
-----------
```

ğŸ‘†ã€€`legal_moves` ã¨æ‰“éµã™ã‚‹ã¨ã€åˆæ³•æ‰‹ã®ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¾ã™

Input:  

```shell
do 4n
```

Output:  

```
[ 1 moves | moved 4n | next white]
    1 2 3 4 5 6 7
  +---------------+
a |               |
b |               |
c |     0 1       |
d |               |
e |               |
f |               |
  +---------------+
[from beginning] sfen startpos moves 4n
                 stones_before_change -
[from present]   sfen 7/7/2ox3/7/7/7 b - 1
```

ğŸ‘†ã€€è©¦ã—ã« `do 4n` ã¨æ‰“éµã—ã¦ãã ã•ã„ã€‚ï¼”ç­‹ã« 1 ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚  
ã“ã‚Œã¯ï¼“ç­‹å…¨ä½“ã‚’ã€ï¼”ç­‹å…¨ä½“ã¸ NOTæ¼”ç®—ã—ãŸã‚‚ã®ã§ã™  

```
COMMAND:
    do [move]

STRUCTURES:

    move = [way][operator]

        way = [1, 2, 3, 4, 5, 6, 7, a, b, c, d, e, f]
        operator = [
            # é›¶é …æ¼”ç®—å­ï¼ˆNullary operatorï¼‰
            s0 = 0-bit rotational logic higher **S**HIFT
            s1 = 1-bit rotational logic higher **S**HIFT
            s2 = 2-bit rotational logic higher **S**HIFT
            s3 = 3-bit rotational logic higher **S**HIFT
            s4 = 4-bit rotational logic higher **S**HIFT
            s5 = 5-bit rotational logic higher **S**HIFT
            s6 = 6-bit rotational logic higher **S**HIFT

            # å˜é …æ¼”ç®—å­ï¼ˆUnary operatorï¼‰
            n  = **N**OT operation
            nH = **N**OT operation from **H**IGHER side
            nL = **N**OT operation from **L**OWER side

            # äºŒé …æ¼”ç®—å­ï¼ˆBinary operatorï¼‰
            a  = **A**ND operation
            o  = **O**R operation
            xo = **XO**R operation

            na = **NA**ND operation
            no = **NO**R operation
            xn = **XN**OR operation

            on = fill **ON**E operation
            ze = fill **ZE**RO operation
            c  = **C**UT of the edge operation
        ]
```

ğŸ‘† `4n` ã¯ã€ **ãƒ ãƒ¼ãƒ–** ï¼ˆMoveï¼‰ã‚³ãƒãƒ³ãƒ‰ã¨å‘¼ã³ã¾ã™ã€‚  
`4n` ã¯ã€ 4 ã¨ã„ã† **è·¯** ï¼ˆWayï¼‰ ã¨ã€ n ã¨ã„ã† **æ¼”ç®—å­** (Operator) ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™  


ğŸ‘‡ã€€ã„ãšã‚Œã®æ¼”ç®—ã§ã‚‚ã€æŒ‡å®šã—ãŸè·¯ãŒ **å¯¾ç§°è·¯** ã«ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªç›¤é¢ãŒã‚ã‚‹ã¨ã—ã¾ã™  

```
    1 2 3 4 5 6 7
  +---------------+
a |               |
b |               |
c |     0         |
d |     1         |
e |     0         |
f |               |
  +---------------+
```

ğŸ‘‡ã€€ã“ã“ã§é›¶é …æ¼”ç®—ã§ã€€3è·¯ã€€ã‚’æŒ‡å®šã—ã€ï¼‘ãƒ“ãƒƒãƒˆã‚·ãƒ•ãƒˆã™ã‚‹ã¨ä¸‹å›³ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

```
    1 2 3 4 5 6 7             1 2 # 4 5 6 7
  +----+-+--------+         +----+-+--------+
a |    | |        |       a |    | |        |
b |    | |        |       b |    | |        |
c |    |0|        |  -->  c |    |0|        |
d |    |1|        |       d |    |0|        |
e |    |0|        |       e |    |1|        |
f |    | |        |       f |    | |        |
  +----+-+--------+         +----+-+--------+
```

ï¼’ãƒ“ãƒƒãƒˆã‚·ãƒ•ãƒˆã™ã‚Œã°ã€ï¼’ã¤ãšã‚Œã¾ã™ã€‚  
ï¼ãƒ“ãƒƒãƒˆã‚·ãƒ•ãƒˆã¯ç¦æ­¢ã—ã¾ã™  

ã¾ãŸã€ 3ç­‹ã®ç¬¦å·ãŒ `#` ã«å¤‰ã‚ã‚Šã¾ã—ãŸãŒã€ã“ã‚Œã¯ **è·¯ãƒ­ãƒƒã‚¯** ï¼ˆWay lockï¼‰ã§ã™ã€‚  
åŒã˜è·¯ã§åå¯¾ã®æ“ä½œã‚’ã‚„ã‚Šè¿”ã•ã‚Œã‚‹ã¨ã€æ°¸é ã«å±€é¢ãŒé€²ã¾ãªã„ã®ã§ã€ãã®è·¯ã¸ã®æ“ä½œã‚’ç¦æ­¢ã™ã‚‹ã‚‚ã®ã§ã™ã€‚  
ä¸€åº¦ä»˜ã„ãŸã€€è·¯ãƒ­ãƒƒã‚¯ã€€ã¯ã€åŒã˜å¯¾å±€ä¸­ã«å¤–ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“  

ğŸ‘‡ã€€æ¬¡ã«ã€å˜é …æ¼”ç®—ã§ã€€4è·¯ã€€ã‚’æŒ‡å®šã—ã€ NOTæ¼”ç®—ã—ãŸä¾‹ã‚’ç¤ºã—ã¾ã™  

```
    1 2 3 4 5 6 7             1 2 3 4 5 6 7  
  +------+-+------+         +------+-+------+
a |      | |      |       a |      | |      |
b |      | |      |       b |      | |      |
c |     0| |      |  -->  c |     0|1|      |
d |     1| |      |       d |     1|0|      |
e |     0| |      |       e |     0|1|      |
f |      | |      |       f |      | |      |
  +------+-+------+         +------+-+------+
```

4è·¯ã«ã¯ã€çŸ³ãŒæœ‰ã£ã¦ã‚‚ç„¡ãã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚ä¸Šå›³ã§ã¯ 4è·¯ã«çŸ³ãŒãªã‹ã£ãŸã‚±ãƒ¼ã‚¹ã§ã™ã€‚  
ã‚‚ã¨ã‚‚ã¨çŸ³ãŒãªã‹ã£ãŸè·¯ã«å¯¾ã—ã¦æ“ä½œã‚’è¡Œã£ãŸã‚±ãƒ¼ã‚¹ã§ã¯ã€è·¯ãƒ­ãƒƒã‚¯ã¯ä»˜ãã¾ã›ã‚“  

ğŸ‘‡ã€€æ¬¡ã«ã€å˜é …æ¼”ç®—ãŒã€€**ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹** ï¼ˆIn-placeï¼›æ—¢ã«çŸ³ã®ç½®ã„ã¦ã‚ã‚‹ã¨ã“ã‚ï¼‰ã§ã‚‚ã§ãã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™  

```
    1 2 3 4 5 6 7             1 2 3 # 5 6 7  
  +------+-+------+         +------+-+------+
a |      | |      |       a |      | |      |
b |      | |      |       b |      | |      |
c |     0|1|1     |  -->  c |     0|0|1     |
d |     1|1|0     |       d |     1|1|0     |
e |     0|0|0     |       e |     0|1|0     |
f |      | |      |       f |      | |      |
  +------+-+------+         +------+-+------+
```

å˜é …æ¼”ç®—ã‚’ã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹ã§è¡Œã†å ´åˆã€å·¦å´ï¼ˆä¸Šå´ï¼‰ã¨å³å´ï¼ˆä¸‹å´ï¼‰ã®ã©ã¡ã‚‰ã‚’å…ƒã«ã™ã‚‹ã‹åˆ¤æ–­ã§ããªã„ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚  
ãã®å ´åˆã€ ï¼ˆ`n` ã§ã¯ãªãã€ï¼‰ `nL` ã‚„ `nH` ã®ã‚ˆã†ã«ã€ Lower ï¼ˆè·¯ã®ç•ªå·ãŒå°ã•ã„ã€å‰æ–¹ã®æ–¹ï¼‰ã‹ Higher ï¼ˆè·¯ã®ç•ªå·ãŒå¤§ãã„ã€å¾Œã‚ã®æ–¹ï¼‰ã‹ã‚’æ˜ç¤ºã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™  

çŸ³ãŒãªã„ã¨ã“ã‚ã«çŸ³ã‚’ç½®ãã®ã¯ã€€**ãƒ‹ãƒ¥ãƒ¼ã™ã‚‹** ï¼ˆNewï¼‰ã¨ã‹ã€ **æ–°è¦ä½œæˆ** ã¨å‘¼ã¶ã“ã¨ã«ã—ã¾ã™ã€‚  
æ—¢ã«ã‚ã‚‹çŸ³ã‚’ã²ã£ãã‚Šè¿”ã—ãŸã‚Šã€ã²ã£ãã‚Šè¿”ã•ãªã‹ã£ãŸã‚Šã™ã‚‹ã“ã¨ã¯ã€€**ãƒ¢ãƒ‡ã‚£ãƒ•ã‚¡ã‚¤ã™ã‚‹** ï¼ˆModifyï¼‰ã¨ã‹ã€ **æ”¹å¤‰** ã¨å‘¼ã¶ã“ã¨ã«ã—ã¾ã™  


ğŸ‘‡ã€€æ¬¡ã«äºŒé …æ¼”ç®—ã®èª¬æ˜ã§ã™ã€‚  
äºŒé …æ¼”ç®—ã«ã‚‚ã€€æ–°è¦ä½œæˆã¨æ”¹å¤‰ãŒã‚ã‚Šã¾ã™ã€‚äºŒé …æ¼”ç®—ã§ 5è·¯ ã‚’æŒ‡å®šã— ANDæ¼”ç®—ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™  

```
    1 2 3 4 5 6 7             1 2 3 4 5 6 7  
  +--------+-+----+         +--------+-+----+
a |        | |    |       a |        | |    |
b |        | |    |       b |        | |    |
c |     0 1| |    |  -->  c |     0 1|0|    |
d |     1 1| |    |       d |     1 1|1|    |
e |     0 0| |    |       e |     0 0|0|    |
f |        | |    |       f |        | |    |
  +--------+-+----+         +--------+-+----+
```

ğŸ‘‡ã€€æ”¹å¤‰ã™ã‚‹ä¾‹ã€‚  
äºŒé …æ¼”ç®—ã§æ”¹å¤‰ã™ã‚‹éš›ã¯ã€ä¸¡éš£ã‚Šã®è·¯ã‚’å…¥åŠ›ã¨ã—ã¦ä½¿ã„ã¾ã™  

```
    1 2 3 4 5 6 7             1 2 3 # 5 6 7  
  +------+-+------+         +------+-+------+
a |      | |      |       a |      | |      |
b |      | |      |       b |      | |      |
c |     0|1|0     |  -->  c |     0|0|0     |
d |     1|1|1     |       d |     1|1|1     |
e |     0|0|0     |       e |     0|0|0     |
f |      | |      |       f |      | |      |
  +------+-+------+         +------+-+------+
```



# å‚è€ƒæ–‡çŒ®

* ğŸ“– [ã‚€ãšã§ã‚‡note ï¼ ãƒ“ãƒŠãƒ¼ã‚·ï¼ˆBinarsiï¼‰ ã‚’å‰µã‚ã†](https://note.com/muzudho/n/na5dce2824aa4)
* ğŸ“– [ã‚„ã­ã†ã‚‰ç‹ãƒ–ãƒ­ã‚° ï¼ å¯¾å±€ã‚²ãƒ¼ãƒ æ¨™æº–é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ææ¡ˆ](https://yaneuraou.yaneu.com/2022/06/07/standard-communication-protocol-for-games/)
